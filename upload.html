<html>
  <head>
    <title>Save Settings</title>
    <style>
      body {
        font-family: sans-serif, helvetica, arial;
        margin-right: 50px;
        margin-left: 120px;
      }
    </style>
    <script type="text/javascript" src="jquery-1.6.2.js"></script>
    <script type="text/javascript" src="jquery.base64.js"></script>
    <script type="text/javascript">
        function upload(files) {
            for (var i = 0; i < files.length; i++) {
                var url, file = files[i];
                if (window.createObjectURL) {
                    url = window.createObjectURL(file)
                } else if (window.createBlobURL) {
                    url = window.createBlobURL(file)
                } else if (window.URL && window.URL.createObjectURL) {
                    url = window.URL.createObjectURL(file)
                } else if (window.webkitURL && window.webkitURL.createObjectURL) {
                    url = window.webkitURL.createObjectURL(file)
                }
            }
           
            $('#image').attr('src', url);

//            var jqxhr = $.get(url, function (data) {
//                localStorage["image"] = data;
//                var bb = new WebKitBlobBuilder();
//                bb.append(data);
//                var url2 = window.webkitURL.createObjectURL(bb.getBlob());
//                $('#image').attr('src', url2);
//                //alert("success:" + data);
//                //$('#image').attr('src', 'data:image/jpg;base64,' + data);

//            })
//              .success(function () { })
//              .error(function () { })
            //              .complete(function () { });

            }
    </script>
  </head>
  <body>
        <h4>Uploader!</h4>
        <input type="file" onchange="upload(this.files)">
        <img id="image" />
    </body>
</html>
